{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="pizzeria-container">
    <!-- Заголовок -->
     
    <h1 class="main-title">Наша Пиццерия!</h1>
    
    <!-- Новинка -->
    <div class="hero-banner" style="flex: 2; position: relative; min-height: 180px;">
      <img src="https://sun9-76.userapi.com/impg/-jSG0x8DSoXQk3f040agb9259b6xH1SC-54k2g/pktpnXTFhOQ.jpg?size=1370x375&quality=95&sign=178ba12cc2fd88db8beca677562de933&type=album" 
           style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px;">
      
      <div style="position: absolute; top: 50%; left: 20px; transform: translateY(-50%); max-width: 300px; background-color: rgba(255, 255, 255, 0.9); padding: 12px; border-radius: 6px; box-shadow: 0 1px 5px rgba(0,0,0,0.1);">
        <h2 style="color: #d35400; margin: 0; font-size: 18px;">НОВИНКА: Пицца Маргарита!</h2>
        <p style="color: #333; font-size: 13px; margin: 8px 0; line-height: 1.3;">Сочная пицца с томатным соусом, тающей моцареллой и ароматным базиликом</p>
        <a href="#" style="display: inline-block; background-color: #e67e22; color: white; padding: 6px 12px; text-decoration: none; border-radius: 3px; font-weight: bold; font-size: 12px;">Попробуйте</a>
      </div>
    </div>

  <!-- Категории -->
<h2 class="section-title">Категории</h2>
<div class="categories-list">
    <button class="category-filter active" data-category-slug="all">ВСЕ</button>
    {% for category in categories %}
    <button class="category-filter" data-category-slug="{{ category.slug }}">
        {{ category.name|upper }}
    </button>
    {% endfor %}
</div>

<!-- Список пицц -->
<h2 class="section-title">Наши пиццы</h2>
<div class="pizzas-grid">
    {% for pizza in pizzas %}
    <div class="pizza-card" data-category-slug="{{ pizza.category.slug }}">
        {% if pizza.image %}
        <img src="{{ pizza.image.url }}" alt="{{ pizza.name }}" class="pizza-image">
        {% else %}
        <div class="pizza-image-placeholder">Нет изображения</div>
        {% endif %}
        
        <div class="pizza-content">
            <h3 class="pizza-title">{{ pizza.name|upper }}</h3>
            <p class="pizza-description">{{ pizza.description|truncatewords:12 }}</p>
            
            <div class="pizza-meta">
                <p class="pizza-category">
                    <span>Категория:</span> {{ pizza.category.name }}
                </p>
                
                <p class="pizza-price">
                    <span>Цена:</span> {{ pizza.price }} ₽
                    <span class="pizza-diameter">({{ pizza.diameter }} см)</span>
                </p>
            </div>
            
            <div class="pizza-link-container">
                <a href="{% url 'pizza_detail' pizza.slug %}" class="pizza-link">
                    Подробнее
                </a>
                {% if pizza.is_available %}
                <button class="order-btn" data-slug="{{ pizza.slug }}">Заказать</button>
                {% else %}
                <span class="out-of-stock">Нет в наличии</span>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <p class="empty-message">Пицц пока нет</p>
    {% endfor %}
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filterButtons = document.querySelectorAll('.category-filter');
        const pizzaCards = document.querySelectorAll('.pizza-card');
        
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Убираем активный класс у всех кнопок
                filterButtons.forEach(btn => btn.classList.remove('active'));
                // Добавляем активный класс текущей кнопке
                this.classList.add('active');
                
                const selectedCategory = this.dataset.categorySlug;
                
                // Фильтруем пиццы с анимацией
                pizzaCards.forEach(card => {
                    if (selectedCategory === 'all' || card.dataset.categorySlug === selectedCategory) {
                        card.style.display = 'block';
                        setTimeout(() => {
                            card.style.opacity = '1';
                            card.style.transform = 'scale(1)';
                        }, 10);
                    } else {
                        card.style.opacity = '0';
                        card.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            card.style.display = 'none';
                        }, 300);
                    }
                });
            });
        });
    });
</script>

<style>
    .category-filter {
    padding: 8px 16px;
    border: none;
    background: #f5f5f5;
    cursor: pointer;
    border-radius: 20px;
    margin-right: 8px;
    margin-bottom: 8px;
    transition: all 0.3s ease;
}

    .category-filter.active {
    background: #ff6b6b;
    color: white;
}

/* Анимация карточек */
    .pizza-card {
    transition: all 0.3s ease;
    opacity: 1;
    transform: scale(1);
}

    .pizza-card.hidden {
    opacity: 0;
    transform: scale(0.95);
    height: 0;
    overflow: hidden;
    margin: 0;
    padding: 0;
    border: none;
}
    .pizzeria-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 15px;
        font-family: Arial, sans-serif;
        font-size: 14px;
    }

    .main-title {
        color: #e67e22;
        text-align: center;
        margin: 0 0 20px 0;
        font-size: 24px;
    }

    .section-title {
        color: #333;
        font-size: 18px;
        border-bottom: 2px solid #e67e22;
        padding-bottom: 8px;
        margin: 25px 0 15px 0;
    }

    .categories-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 20px;
    }

    .category-item {
        padding: 6px 12px;
        background-color: #f1f1f1;
        border-radius: 20px;
        text-decoration: none;
        color: #333;
        transition: all 0.3s;
        font-size: 13px;
    }

    .category-item.active, .category-item:hover {
        background-color: #e67e22;
        color: white;
    }

    .pizzas-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
        align-items: stretch;
    }

    .pizza-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        transition: transform 0.3s;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    .pizza-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    
    .pizza-image {
        width: 100%;
        height: 120px;
        object-fit: cover;
    }
    
    .pizza-content {
        padding: 12px;
        display: flex;
        flex-direction: column;
        flex-grow: 1;
    }

    .pizza-title {
        color: #d35400;
        margin: 0 0 8px 0;
        font-size: 15px;
    }

    .pizza-description {
        color: #666;
        line-height: 1.4;
        font-size: 13px;
        margin: 0 0 8px 0;
    }

    .pizza-category, .pizza-price {
        color: #333;
        margin: 6px 0;
        font-size: 13px;
    }
    
    .pizza-price {
        font-weight: bold;
        color: #d35400;
    }

    .pizza-link-container {
        margin-top: auto;
        padding-top: 8px;
    }

    .pizza-link {
        display: inline-block;
        background-color: #e67e22;
        color: white;
        padding: 6px 12px;
        border-radius: 4px;
        text-decoration: none;
        font-size: 13px;
    }

    .empty-message {
        grid-column: 1 / -1;
        text-align: center;
        color: #666;
        padding: 30px;
        font-size: 14px;
    }

    @media (max-width: 768px) {
        .pizzas-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}